{
    "problemName": "new-users-daily-count",
    "language": "mysql",
    "code": "# Write your MySQL query statement below\n\nWITH cte AS \n(SELECT user_id, MIN(activity_date) AS first_login\nFROM Traffic\nWHERE activity='login' \nGROUP BY 1)\n\n\nSELECT activity_date AS login_date, COUNT(DISTINCT t.user_id) AS user_count \nFROM Traffic t\nJOIN cte\nON cte.user_id = t.user_id AND cte.first_login = t.activity_date\nWHERE t.activity_date BETWEEN DATE_SUB('2019-06-30',INTERVAL 90 DAY) AND '2019-06-30'\nGROUP BY 1\n\n\n\n\n\n\n\n# WITH cte AS\n# (SELECT user_id, MIN(activity_date) AS first_login\n# FROM Traffic\n# WHERE activity = 'login'\n# GROUP BY user_id)\n\n\n# SELECT activity_date AS login_date, COUNT(DISTINCT t.user_id) AS user_count\n# FROM Traffic t\n# JOIN cte \n# ON t.user_id = cte.user_id AND t.activity_date = cte.first_login\n# WHERE t.activity_date BETWEEN DATE_SUB('2019-06-30', INTERVAL 90 DAY) AND '2019-06-30'\n# GROUP BY 1\n\n\n\n\n# Swith cte as (\n\n#     select user_id, activity, activity_date, row_number() over (partition by user_id order by activity_date) as rowwy\n#     from Traffic\n#     where activity = \"login\" \n\n# )\n\n# select activity_date as login_date, count(*) as user_count\n# from cte\n# where activity_date between date_sub(\"2019-06-30\", interval 90 day) and \"2019-06-30\" and rowwy = 1\n# group by 1"
}