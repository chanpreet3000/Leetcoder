{
    "problemName": "design-log-storage-system",
    "language": "java",
    "code": "public class LogSystem {\n    TreeMap < Long, Integer > map;\n    public LogSystem() {\n        map = new TreeMap < Long, Integer > ();\n    }\n\n    public void put(int id, String timestamp) {\n        int[] st = Arrays.stream(timestamp.split(\":\")).mapToInt(Integer::parseInt).toArray();\n        map.put(convert(st), id);\n    }\n    public long convert(int[] st) {\n        st[1] = st[1] - (st[1] == 0 ? 0 : 1);\n        st[2] = st[2] - (st[2] == 0 ? 0 : 1);\n        return (st[0] - 1999L) * (31 * 12) * 24 * 60 * 60 + st[1] * 31 * 24 * 60 * 60 + st[2] * 24 * 60 * 60 + st[3] * 60 * 60 + st[4] * 60 + st[5];\n    }\n    public List < Integer > retrieve(String s, String e, String gra) {\n        ArrayList < Integer > res = new ArrayList();\n        long start = granularity(s, gra, false);\n        long end = granularity(e, gra, true);\n        for (long key: map.tailMap(start).keySet()) {\n            if (key >= start && key < end)\n                res.add(map.get(key));\n        }\n        return res;\n    }\n\n    public long granularity(String s, String gra, boolean end) {\n        HashMap < String, Integer > h = new HashMap();\n        h.put(\"Year\", 0);\n        h.put(\"Month\", 1);\n        h.put(\"Day\", 2);\n        h.put(\"Hour\", 3);\n        h.put(\"Minute\", 4);\n        h.put(\"Second\", 5);\n        String[] res = new String[] {\"1999\", \"00\", \"00\", \"00\", \"00\", \"00\"};\n        String[] st = s.split(\":\");\n        for (int i = 0; i <= h.get(gra); i++) {\n            res[i] = st[i];\n        }\n        int[] t = Arrays.stream(res).mapToInt(Integer::parseInt).toArray();\n        if (end)\n            t[h.get(gra)]++;\n        return convert(t);\n    }\n}\n\n/**\n * Your LogSystem object will be instantiated and called as such:\n * LogSystem obj = new LogSystem();\n * obj.put(id,timestamp);\n * List<Integer> param_2 = obj.retrieve(start,end,granularity);\n */"
}